<style lang="less">
.xh-ad-box {
  position: relative;
  padding-left: 40rpx;
  padding-right: 40rpx;
  background: #fff;
  .ad-close-btn {
    position: absolute;
    right: 43rpx;
    top: 3rpx;
    width: 33rpx;
    height: 33rpx;
    z-index: 11;
  }
}
</style>
<template>
  <view class="xh-ad-box {{styleClass}}" wx:if="{{showAdBox && !fromService && unitId && !isQB}}">
    <image class="ad-close-btn" src="../../images/close.png" @tap='closeAdBox'></image>
    <ad unit-id="{{unitId}}"></ad>
  </view>
</template>
<script>
import wepy from "wepy";
export default class XhAdBox extends wepy.component {
  props = {
    showAdBox: {
      type: Boolean,
      default: false
    },
    fromService: {
      type: Boolean,
      default: false
    },
    unitId: {
      type: String,
      default: ""
    },
    styleClass: {
      type: String,
      default: ""
    }
  };
  data = {
    isQB: false,
    adCallPay: false // å¹¿å‘Šæ‹‰èµ·æ”¯ä»˜
  };
  onLoad() {
    this.adCallPay = wepy.getStorageSync("adCallPay");
    let that = this;
    wx.getSystemInfo({
      success: function(res) {
        that.isQB = res.isQB;
        that.$apply();
      }
    });
  }
  /*
  å…¨ç«™å¹¿å‘Šç»„ä»¶ï¼šä¸€å¤©å†…å…¨ç«™å¹¿å‘Šçš„å…³é—­æŒ‰é’®åªä¼šæ‹‰èµ·æ”¯ä»˜ä¸€æ¬¡ï¼›ç¬¬äºŒæ¬¡ç›´æ¥å…³é—­å¹¿å‘Š
  å“¼ï¼›äººå®¶å¯çˆ±çš„ç”¨æˆ·ç‚¹å…³é—­ï¼›ä»°é¹å´è¾£ä¹ˆé‚ªæ¶ğŸ˜ˆçš„è®©æ‹‰èµ·æ”¯ä»˜ï¼›å¦‚æ­¤ä¸è¦xçš„è¡Œä¸ºï¼›ä¹Ÿåªæœ‰
  æˆ‘ä»¬çš„NBäº§å“æ‰èƒ½æƒ³å¾—åˆ°ï¼›ä½©æœä½©æœï½ï½
  */
  methods = {
    closeAdBox() {
      this.showAdBox = false;
      // å•ç‹¬åŒºåˆ†èœè°±è¯¦æƒ…å¤„å¹¿å‘Šæ‹‰èµ·æ”¯ä»˜åçš„å…³é—­æŒ‰é’®ğŸŒ¹
      if (this.unitId == "adunit-287a09fdb8ef1ea7") {
        this.$emit("closeAd");
      }
      // å½“å‰æ˜¯å…è®¸å¹¿å‘Šæ‹‰èµ·æ”¯ä»˜ğŸŒŠ
      if (this.adCallPay) {
        this.$emit("payPop"); // æ“ä½œæ”¯ä»˜å¼¹å±‚çš„æ˜¾ç¤ºéšè—
      }
      wepy.setStorageSync("adCallPay", false);
    }
  };
}
</script>
